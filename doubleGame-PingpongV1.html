<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<title>åŒäººä¹’ä¹“çƒ Â· åŒå±å¯¹æˆ˜</title>
	<style>
		* {
			box-sizing: border-box;
			user-select: none;
			-webkit-tap-highlight-color: transparent;
		}
		body {
			margin: 0;
			min-height: 100vh;
			background: linear-gradient(145deg, #0b1c2f, #1a2f42);
			display: flex;
			justify-content: center;
			align-items: center;
			font-family: 'Segoe UI', Roboto, sans-serif;
			padding: 10px;
			touch-action: pan-y pinch-zoom;
		}
		.game-container {
			width: 100%;
			max-width: 500px;
			background: #1e3a5f;
			border-radius: 40px;
			padding: 20px;
			box-shadow: 0 20px 35px #00000080;
			border: 2px solid #4c7aa2;
		}
		.header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			color: #e6f0ff;
			font-size: 1.2rem;
			font-weight: 700;
			margin-bottom: 15px;
			padding: 0 10px;
		}
		.score-board {
			background: #0f2a40;
			padding: 8px 30px;
			border-radius: 40px;
			display: flex;
			gap: 40px;
		}
		.score-left, .score-right {
			display: flex;
			align-items: center;
			gap: 8px;
			font-size: 1.3rem;
		}
		.score-left span, .score-right span {
			font-size: 2rem;
			color: #ffb347;
			min-width: 40px;
			text-align: center;
		}
		canvas {
			display: block;
			margin: 0 auto;
			width: 100%;
			aspect-ratio: 1/1;
			border-radius: 30px;
			background: #1a472a;
			box-shadow: inset 0 0 30px #00000099, 0 10px 15px black;
			border: 4px solid #c0a86a;
			touch-action: none;
		}
		.controls-row {
			display: flex;
			justify-content: space-between;
			margin-top: 20px;
			gap: 15px;
		}
		.player-controls {
			flex: 1;
			display: flex;
			flex-direction: column;
			align-items: center;
			background: #0f2a40;
			border-radius: 30px;
			padding: 15px 10px;
			border: 2px solid #3a6792;
		}
		.player-label {
			color: #d7ecff;
			font-weight: bold;
			margin-bottom: 12px;
			font-size: 1.1rem;
		}
		.player-label.left {
			color: #3b82f6;
		}
		.player-label.right {
			color: #dc2626;
		}
		.paddle-control {
			display: flex;
			flex-direction: column;
			align-items: center;
			width: 100%;
			gap: 10px;
		}
		.ctrl-btn {
			background: #2d4b6e;
			border: none;
			color: white;
			font-size: 2rem;
			font-weight: bold;
			width: 80px;
			height: 80px;
			border-radius: 50px;
			box-shadow: 0 5px 0 #0e2637;
			transition: 0.05s;
			display: flex;
			align-items: center;
			justify-content: center;
			touch-action: manipulation;
			cursor: pointer;
			-webkit-tap-highlight-color: transparent;
		}
		.ctrl-btn:active {
			transform: translateY(4px);
			box-shadow: 0 1px 0 #0e2637;
		}
		.ctrl-btn.left-color {
			background: #3b82f6;
		}
		.ctrl-btn.right-color {
			background: #dc2626;
		}
		.speed-control {
			display: flex;
			gap: 10px;
			margin-top: 10px;
			justify-content: center;
		}
		.speed-btn {
			background: #4a6a8a;
			border: none;
			color: white;
			font-size: 1rem;
			padding: 8px 16px;
			border-radius: 30px;
			box-shadow: 0 3px 0 #1e3a5f;
			cursor: pointer;
			touch-action: manipulation;
		}
		.speed-btn.active {
			background: #ffb347;
			color: #1e2f47;
			font-weight: bold;
		}
		.footer {
			text-align: center;
			margin-top: 15px;
			color: #8aa9c9;
			font-size: 0.9rem;
		}
		.victory-message {
			position: fixed;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			background: rgba(0,0,0,0.9);
			color: gold;
			font-size: 2.5rem;
			font-weight: bold;
			padding: 30px 50px;
			border-radius: 60px;
			border: 4px solid gold;
			z-index: 1000;
			display: none;
			text-align: center;
			backdrop-filter: blur(10px);
		}
		.restart-btn {
			background: #ffb347;
			border: none;
			color: #1e2f47;
			font-size: 1.2rem;
			padding: 10px 30px;
			border-radius: 40px;
			margin-top: 15px;
			font-weight: bold;
			cursor: pointer;
		}
	</style>
</head>
<body>
	<div class="victory-message" id="victoryMessage">
		ğŸ† ç©å®¶è·èƒœ ğŸ†
		<div><button class="restart-btn" onclick="location.reload()">å†ç©ä¸€å±€</button></div>
	</div>

	<div class="game-container">
		<div class="header">
			<span>ğŸ“ åŒäººä¹’ä¹“çƒ</span>
			<div class="score-board">
				<div class="score-left">ğŸ”µ <span id="scoreLeft">0</span></div>
				<div class="score-right">ğŸ”´ <span id="scoreRight">0</span></div>
			</div>
		</div>

		<canvas id="gameCanvas" width="400" height="400"></canvas>

		<!-- åŒäººæ§åˆ¶åŒºåŸŸ -->
		<div class="controls-row">
			<!-- å·¦ä¾§ç©å®¶ (è“è‰²) -->
			<div class="player-controls">
				<div class="player-label left">ğŸ‘ˆ è“æ–¹</div>
				<div class="paddle-control">
					<button class="ctrl-btn left-color" id="leftUp">â¬†ï¸</button>
					<button class="ctrl-btn left-color" id="leftDown">â¬‡ï¸</button>
				</div>
			</div>

			<!-- å³ä¾§ç©å®¶ (çº¢è‰²) -->
			<div class="player-controls">
				<div class="player-label right">ğŸ‘‰ çº¢æ–¹</div>
				<div class="paddle-control">
					<button class="ctrl-btn right-color" id="rightUp">â¬†ï¸</button>
					<button class="ctrl-btn right-color" id="rightDown">â¬‡ï¸</button>
				</div>
			</div>
		</div>

		<!-- é€Ÿåº¦æ§åˆ¶ -->
		<div class="speed-control">
			<button class="speed-btn" id="speedSlow">ğŸ¢ æ…¢é€Ÿ</button>
			<button class="speed-btn active" id="speedMedium">âš¡ ä¸­é€Ÿ</button>
			<button class="speed-btn" id="speedFast">ğŸš€ å¿«é€Ÿ</button>
		</div>

		<div class="footer">
			ä¸Šä¸‹ç§»åŠ¨çƒæ‹ Â· å…ˆå¾—7åˆ†è·èƒœ
		</div>
	</div>

	<script>
		(function() {
			const canvas = document.getElementById('gameCanvas');
			const ctx = canvas.getContext('2d');
			const victoryMsg = document.getElementById('victoryMessage');

			// æ¸¸æˆé…ç½®
			const config = {
				paddleWidth: 12,
				paddleHeight: 70,
				paddleSpeed: 6,
				ballRadius: 6,
				winScore: 7
			};

			// çƒæ‹ä½ç½®
			let leftPaddle = {
				x: 30,
				y: canvas.height / 2 - config.paddleHeight / 2,
				w: config.paddleWidth,
				h: config.paddleHeight
			};
			let rightPaddle = {
				x: canvas.width - 30 - config.paddleWidth,
				y: canvas.height / 2 - config.paddleHeight / 2,
				w: config.paddleWidth,
				h: config.paddleHeight
			};

			// çƒ
			let ball = {
				x: canvas.width / 2,
				y: canvas.height / 2,
				r: config.ballRadius,
				vx: 4,
				vy: 3
			};

			// åˆ†æ•°
			let leftScore = 0;
			let rightScore = 0;

			// ç§»åŠ¨çŠ¶æ€
			const leftMove = { up: false, down: false };
			const rightMove = { up: false, down: false };

			// é€Ÿåº¦ç­‰çº§
			let speedLevel = 'medium'; // slow, medium, fast
			const speedMap = {
				slow: { ball: 3, paddle: 4 },
				medium: { ball: 5, paddle: 6 },
				fast: { ball: 7, paddle: 8 }
			};

			// åˆ†æ•°æ˜¾ç¤º
			const scoreLeftEl = document.getElementById('scoreLeft');
			const scoreRightEl = document.getElementById('scoreRight');

			// é€Ÿåº¦æŒ‰é’®
			document.getElementById('speedSlow').addEventListener('click', () => {
				speedLevel = 'slow';
				updateSpeedButtons();
				updateSpeed();
			});
			document.getElementById('speedMedium').addEventListener('click', () => {
				speedLevel = 'medium';
				updateSpeedButtons();
				updateSpeed();
			});
			document.getElementById('speedFast').addEventListener('click', () => {
				speedLevel = 'fast';
				updateSpeedButtons();
				updateSpeed();
			});

			function updateSpeedButtons() {
				document.querySelectorAll('.speed-btn').forEach(btn => btn.classList.remove('active'));
				if (speedLevel === 'slow') document.getElementById('speedSlow').classList.add('active');
				if (speedLevel === 'medium') document.getElementById('speedMedium').classList.add('active');
				if (speedLevel === 'fast') document.getElementById('speedFast').classList.add('active');
			}

			function updateSpeed() {
				const speed = speedMap[speedLevel];
				// ä¿æŒå½“å‰æ–¹å‘ï¼Œåªæ”¹å˜é€Ÿåº¦å¤§å°
				const ballSpeed = Math.sqrt(ball.vx * ball.vx + ball.vy * ball.vy);
				if (ballSpeed > 0) {
					const ratio = speed.ball / ballSpeed;
					ball.vx = ball.vx * ratio;
					ball.vy = ball.vy * ratio;
				}
				// çƒæ‹é€Ÿåº¦ä¸éœ€è¦ç«‹å³æ”¹å˜ï¼Œä¼šåœ¨ç§»åŠ¨æ—¶ä½¿ç”¨
			}

			// è§¦æ‘¸ç»‘å®š
			function bindButton(btnId, playerMove, dir) {
				const btn = document.getElementById(btnId);
				if (!btn) return;
				
				btn.addEventListener('touchstart', (e) => {
					e.preventDefault();
					playerMove[dir] = true;
				});
				btn.addEventListener('touchend', (e) => {
					e.preventDefault();
					playerMove[dir] = false;
				});
				btn.addEventListener('touchcancel', (e) => {
					e.preventDefault();
					playerMove[dir] = false;
				});
				btn.addEventListener('mousedown', (e) => {
					e.preventDefault();
					playerMove[dir] = true;
				});
				btn.addEventListener('mouseup', (e) => {
					e.preventDefault();
					playerMove[dir] = false;
				});
				btn.addEventListener('mouseleave', (e) => {
					playerMove[dir] = false;
				});
			}

			bindButton('leftUp', leftMove, 'up');
			bindButton('leftDown', leftMove, 'down');
			bindButton('rightUp', rightMove, 'up');
			bindButton('rightDown', rightMove, 'down');

			// é‡ç½®çƒ
			function resetBall(scorer) {
				ball.x = canvas.width / 2;
				ball.y = canvas.height / 2;
				
				// éšæœºæ–¹å‘ï¼Œä½†åå‘å¤±åˆ†æ–¹
				let baseAngle;
				if (scorer === 'left') {
					// è“æ–¹å¾—åˆ†ï¼Œçƒå‘å‘çº¢æ–¹
					baseAngle = Math.random() * 0.8 - 0.4; // -0.4 åˆ° 0.4 å¼§åº¦
				} else {
					// çº¢æ–¹å¾—åˆ†ï¼Œçƒå‘å‘è“æ–¹
					baseAngle = Math.PI + (Math.random() * 0.8 - 0.4);
				}
				
				const speed = speedMap[speedLevel].ball;
				ball.vx = Math.cos(baseAngle) * speed;
				ball.vy = Math.sin(baseAngle) * speed * 0.8; // å‚ç›´é€Ÿåº¦ç¨å°
				
				// ç¡®ä¿çƒä¸ä¼šå¤ªå¹³
				if (Math.abs(ball.vy) < 1.5) {
					ball.vy = ball.vy > 0 ? 2 : -2;
				}
			}

			// æ£€æŸ¥èƒœåˆ©
			function checkWin() {
				if (leftScore >= config.winScore) {
					victoryMsg.style.display = 'block';
					victoryMsg.innerHTML = 'ğŸ† è“æ–¹èƒœåˆ© ğŸ†<div><button class="restart-btn" onclick="location.reload()">å†ç©ä¸€å±€</button></div>';
					return true;
				} else if (rightScore >= config.winScore) {
					victoryMsg.style.display = 'block';
					victoryMsg.innerHTML = 'ğŸ† çº¢æ–¹èƒœåˆ© ğŸ†<div><button class="restart-btn" onclick="location.reload()">å†ç©ä¸€å±€</button></div>';
					return true;
				}
				return false;
			}

			// æ›´æ–°çƒæ‹ä½ç½®
			function updatePaddles() {
				const paddleSpeed = speedMap[speedLevel].paddle;
				
				if (leftMove.up) leftPaddle.y -= paddleSpeed;
				if (leftMove.down) leftPaddle.y += paddleSpeed;
				if (rightMove.up) rightPaddle.y -= paddleSpeed;
				if (rightMove.down) rightPaddle.y += paddleSpeed;

				// è¾¹ç•Œé™åˆ¶
				leftPaddle.y = Math.max(0, Math.min(canvas.height - leftPaddle.h, leftPaddle.y));
				rightPaddle.y = Math.max(0, Math.min(canvas.height - rightPaddle.h, rightPaddle.y));
			}

			// æ›´æ–°çƒ
			function updateBall() {
				if (checkWin()) return;

				ball.x += ball.vx;
				ball.y += ball.vy;

				// ä¸Šä¸‹è¾¹ç•Œåå¼¹
				if (ball.y - ball.r < 0) {
					ball.y = ball.r;
					ball.vy = -ball.vy;
				} else if (ball.y + ball.r > canvas.height) {
					ball.y = canvas.height - ball.r;
					ball.vy = -ball.vy;
				}

				// å·¦å³è¾¹ç•Œï¼ˆå¾—åˆ†ï¼‰
				if (ball.x - ball.r < 0) {
					// çº¢æ–¹å¾—åˆ†
					rightScore++;
					scoreRightEl.innerText = rightScore;
					resetBall('right');
					return;
				} else if (ball.x + ball.r > canvas.width) {
					// è“æ–¹å¾—åˆ†
					leftScore++;
					scoreLeftEl.innerText = leftScore;
					resetBall('left');
					return;
				}

				// å·¦çƒæ‹ç¢°æ’
				if (ball.x - ball.r < leftPaddle.x + leftPaddle.w && 
					ball.x + ball.r > leftPaddle.x &&
					ball.y > leftPaddle.y && 
					ball.y < leftPaddle.y + leftPaddle.h) {
					
					// è®¡ç®—åå¼¹è§’åº¦ï¼ˆåŸºäºå‡»çƒä½ç½®ï¼‰
					let relativeY = (ball.y - (leftPaddle.y + leftPaddle.h/2)) / (leftPaddle.h/2);
					let angle = relativeY * 0.8; // -0.8 åˆ° 0.8 å¼§åº¦
					
					// ç¡®ä¿çƒå‘å³é£
					let speed = Math.sqrt(ball.vx * ball.vx + ball.vy * ball.vy);
					ball.vx = Math.abs(Math.cos(angle) * speed);
					ball.vy = Math.sin(angle) * speed;
					
					// ç¨å¾®å¢åŠ é€Ÿåº¦
					ball.vx *= 1.05;
					ball.vy *= 1.05;
					
					// é˜²æ­¢çƒå¡åœ¨æ‹å­é‡Œ
					ball.x = leftPaddle.x + leftPaddle.w + ball.r;
				}

				// å³çƒæ‹ç¢°æ’
				if (ball.x + ball.r > rightPaddle.x && 
					ball.x - ball.r < rightPaddle.x + rightPaddle.w &&
					ball.y > rightPaddle.y && 
					ball.y < rightPaddle.y + rightPaddle.h) {
					
					let relativeY = (ball.y - (rightPaddle.y + rightPaddle.h/2)) / (rightPaddle.h/2);
					let angle = Math.PI - relativeY * 0.8; // å‘å·¦åå¼¹
					
					let speed = Math.sqrt(ball.vx * ball.vx + ball.vy * ball.vy);
					ball.vx = -Math.abs(Math.cos(angle) * speed);
					ball.vy = Math.sin(angle) * speed;
					
					ball.vx *= 1.05;
					ball.vy *= 1.05;
					
					ball.x = rightPaddle.x - ball.r;
				}
			}

			// ç»˜åˆ¶
			function draw() {
				ctx.clearRect(0, 0, canvas.width, canvas.height);

				// ç»˜åˆ¶æ¡Œé¢
				ctx.fillStyle = '#2d5a2d';
				ctx.fillRect(0, 0, canvas.width, canvas.height);
				
				// ç»˜åˆ¶ä¸­çº¿
				ctx.strokeStyle = '#ffffff55';
				ctx.lineWidth = 2;
				ctx.setLineDash([10, 10]);
				ctx.beginPath();
				ctx.moveTo(canvas.width/2, 0);
				ctx.lineTo(canvas.width/2, canvas.height);
				ctx.stroke();
				
				// ç»˜åˆ¶ä¸­å¿ƒåœ†
				ctx.setLineDash([]);
				ctx.beginPath();
				ctx.arc(canvas.width/2, canvas.height/2, 40, 0, Math.PI*2);
				ctx.strokeStyle = '#ffffff55';
				ctx.lineWidth = 2;
				ctx.stroke();

				// ç»˜åˆ¶å·¦çƒæ‹
				ctx.shadowBlur = 15;
				ctx.shadowColor = '#00000080';
				ctx.fillStyle = '#3b82f6';
				ctx.fillRect(leftPaddle.x, leftPaddle.y, leftPaddle.w, leftPaddle.h);
				
				// çƒæ‹è¾¹æ¡†
				ctx.strokeStyle = '#1e3a8a';
				ctx.lineWidth = 2;
				ctx.strokeRect(leftPaddle.x, leftPaddle.y, leftPaddle.w, leftPaddle.h);

				// ç»˜åˆ¶å³çƒæ‹
				ctx.fillStyle = '#dc2626';
				ctx.fillRect(rightPaddle.x, rightPaddle.y, rightPaddle.w, rightPaddle.h);
				ctx.strokeStyle = '#991b1b';
				ctx.strokeRect(rightPaddle.x, rightPaddle.y, rightPaddle.w, rightPaddle.h);

				// ç»˜åˆ¶çƒ
				ctx.beginPath();
				ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI*2);
				
				// çƒä½“æ¸å˜
				const gradient = ctx.createRadialGradient(
					ball.x - 2, ball.y - 2, 2,
					ball.x, ball.y, ball.r + 4
				);
				gradient.addColorStop(0, '#ffffff');
				gradient.addColorStop(0.5, '#f5f5dc');
				gradient.addColorStop(1, '#c0a86a');
				
				ctx.fillStyle = gradient;
				ctx.fill();
				ctx.strokeStyle = '#8b7355';
				ctx.lineWidth = 1;
				ctx.stroke();
				
				// çƒçš„é«˜å…‰
				ctx.beginPath();
				ctx.arc(ball.x - 2, ball.y - 2, 2, 0, Math.PI*2);
				ctx.fillStyle = '#ffffff80';
				ctx.fill();

				// ç»˜åˆ¶åˆ†æ•°èƒŒæ™¯
				ctx.shadowBlur = 0;
				ctx.fillStyle = '#00000080';
				ctx.font = 'bold 48px monospace';
				ctx.fillText(leftScore, canvas.width/4, 70);
				ctx.fillStyle = '#ffffff';
				ctx.font = 'bold 48px monospace';
				ctx.fillText(leftScore, canvas.width/4 - 2, 68);
				
				ctx.fillStyle = '#00000080';
				ctx.fillText(rightScore, canvas.width*3/4 - 40, 70);
				ctx.fillStyle = '#ffffff';
				ctx.fillText(rightScore, canvas.width*3/4 - 42, 68);
			}

			// æ¸¸æˆå¾ªç¯
			function gameLoop() {
				updatePaddles();
				updateBall();
				draw();
				requestAnimationFrame(gameLoop);
			}
			gameLoop();

			// é˜»æ­¢æ»šåŠ¨
			document.body.addEventListener('touchmove', (e) => {
				if (e.target.closest('button')) {
					e.preventDefault();
				}
			}, { passive: false });
		})();
	</script>
</body>
</html>